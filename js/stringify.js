// koffee 1.3.0

/*
 0000000  000000000  00000000   000  000   000   0000000   000  00000000  000   000
000          000     000   000  000  0000  000  000        000  000        000 000 
0000000      000     0000000    000  000 0 000  000  0000  000  000000      00000  
     000     000     000   000  000  000  0000  000   000  000  000          000   
0000000      000     000   000  000  000   000   0000000   000  000          000
 */
var defaults, regs, rpad, stringify,
    hasProp = {}.hasOwnProperty,
    indexOf = [].indexOf;

defaults = {
    ext: '.noon',
    indent: 4,
    align: true,
    maxalign: 32,
    sort: false,
    circular: false,
    "null": false,
    colors: false
};

regs = {
    url: new RegExp('^(https?|git|file)(://)(\\S+)$'),
    path: new RegExp('^([\\.\\/\\S]+)(\\/\\S+)$'),
    semver: new RegExp('\\d+\\.\\d+\\.\\d+')
};

rpad = function(s, l) {
    while (s.length < l) {
        s += ' ';
    }
    return s;
};

stringify = function(obj, options) {
    var cs, def, escape, indstr, opt, pretty, s, toStr;
    if (options == null) {
        options = {};
    }
    def = function(o, d) {
        var k, r, v;
        r = {};
        for (k in o) {
            v = o[k];
            r[k] = v;
        }
        for (k in d) {
            v = d[k];
            if (r[k] == null) {
                r[k] = v;
            }
        }
        return r;
    };
    opt = def(options, defaults);
    if (opt.ext === '.json') {
        cs = JSON.stringify(obj, null, opt.indent);
        if (opt.colors) {
            return require('klor').syntax({
                text: cs,
                ext: opt.ext
            });
        } else {
            return cs;
        }
    }
    if (typeof opt.indent === 'string') {
        opt.indent = opt.indent.length;
    }
    indstr = rpad('', opt.indent);
    escape = function(k, arry) {
        var es, ref, ref1, sp;
        if (0 <= k.indexOf('\n')) {
            sp = k.split('\n');
            es = sp.map(function(s) {
                return escape(s, arry);
            });
            es.unshift('...');
            es.push('...');
            return es.join('\n');
        }
        if (k === '' || k === '...' || ((ref = k[0]) === ' ' || ref === '#' || ref === '|') || ((ref1 = k[k.length - 1]) === ' ' || ref1 === '#' || ref1 === '|')) {
            k = '|' + k + '|';
        } else if (arry && /\ \ /.test(k)) {
            k = '|' + k + '|';
        }
        return k;
    };
    pretty = function(o, ind, visited) {
        var j, k, keyValue, kl, l, len, maxKey, ref, v;
        if (opt.align) {
            maxKey = opt.indent;
            if (Object.keys(o).length > 1) {
                for (k in o) {
                    if (!hasProp.call(o, k)) continue;
                    v = o[k];
                    kl = parseInt(Math.ceil((k.length + 2) / opt.indent) * opt.indent);
                    maxKey = Math.max(maxKey, kl);
                    if (opt.maxalign && (maxKey > opt.maxalign)) {
                        maxKey = opt.maxalign;
                        break;
                    }
                }
            }
        }
        l = [];
        keyValue = function(k, v) {
            var i, ks, s, vs;
            s = ind;
            k = escape(k, true);
            if (k.indexOf('  ') > 0 && k[0] !== '|') {
                k = "|" + k + "|";
            } else if (k[0] !== '|' && k[k.length - 1] === '|') {
                k = '|' + k;
            } else if (k[0] === '|' && k[k.length - 1] !== '|') {
                k += '|';
            }
            if (opt.align) {
                ks = rpad(k, Math.max(maxKey, k.length + 2));
                i = rpad(ind + indstr, maxKey);
            } else {
                ks = rpad(k, k.length + 2);
                i = ind + indstr;
            }
            s += ks;
            vs = toStr(v, i, false, visited);
            if (vs[0] === '\n') {
                while (s[s.length - 1] === ' ') {
                    s = s.substr(0, s.length - 1);
                }
            }
            s += vs;
            while (s[s.length - 1] === ' ') {
                s = s.substr(0, s.length - 1);
            }
            return s;
        };
        if (opt.sort) {
            ref = Object.keys(o).sort();
            for (j = 0, len = ref.length; j < len; j++) {
                k = ref[j];
                l.push(keyValue(k, o[k]));
            }
        } else {
            for (k in o) {
                if (!hasProp.call(o, k)) continue;
                v = o[k];
                l.push(keyValue(k, v));
            }
        }
        return l.join('\n');
    };
    toStr = function(o, ind, arry, visited) {
        var ref, ref1, s, t, v;
        if (ind == null) {
            ind = '';
        }
        if (arry == null) {
            arry = false;
        }
        if (visited == null) {
            visited = [];
        }
        if (o == null) {
            if (o === null) {
                return opt["null"] || arry && "null" || '';
            }
            if (o === void 0) {
                return "undefined";
            }
            return '<?>';
        }
        switch (t = typeof o) {
            case 'string':
                return escape(o, arry);
            case 'object':
                if (opt.circular) {
                    if (indexOf.call(visited, o) >= 0) {
                        return '<v>';
                    }
                    visited.push(o);
                }
                if (((ref = o.constructor) != null ? ref.name : void 0) === 'Array') {
                    s = ind !== '' && arry && '.' || '';
                    if (o.length && ind !== '') {
                        s += '\n';
                    }
                    s += ((function() {
                        var j, len, results;
                        results = [];
                        for (j = 0, len = o.length; j < len; j++) {
                            v = o[j];
                            results.push(ind + toStr(v, ind + indstr, true, visited));
                        }
                        return results;
                    })()).join('\n');
                } else if (((ref1 = o.constructor) != null ? ref1.name : void 0) === 'RegExp') {
                    return o.source;
                } else {
                    s = (arry && '.\n') || ((ind !== '') && '\n' || '');
                    s += pretty(o, ind, visited);
                }
                return s;
            default:
                return String(o);
        }
        return '<???>';
    };
    s = toStr(obj);
    if (opt.colors) {
        s = require('klor').syntax({
            text: s,
            ext: 'noon'
        });
    }
    return s;
};

module.exports = stringify;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyaW5naWZ5LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSwrQkFBQTtJQUFBOzs7QUFRQSxRQUFBLEdBQ0k7SUFBQSxHQUFBLEVBQVUsT0FBVjtJQUNBLE1BQUEsRUFBVSxDQURWO0lBRUEsS0FBQSxFQUFVLElBRlY7SUFHQSxRQUFBLEVBQVUsRUFIVjtJQUlBLElBQUEsRUFBVSxLQUpWO0lBS0EsUUFBQSxFQUFVLEtBTFY7SUFNQSxDQUFBLElBQUEsQ0FBQSxFQUFVLEtBTlY7SUFPQSxNQUFBLEVBQVUsS0FQVjs7O0FBVUosSUFBQSxHQUNJO0lBQUEsR0FBQSxFQUFRLElBQUksTUFBSixDQUFXLGdDQUFYLENBQVI7SUFDQSxJQUFBLEVBQVEsSUFBSSxNQUFKLENBQVcsMkJBQVgsQ0FEUjtJQUVBLE1BQUEsRUFBUSxJQUFJLE1BQUosQ0FBVyxvQkFBWCxDQUZSOzs7QUFJSixJQUFBLEdBQU8sU0FBQyxDQUFELEVBQUksQ0FBSjtBQUNILFdBQU0sQ0FBQyxDQUFDLE1BQUYsR0FBVyxDQUFqQjtRQUNJLENBQUEsSUFBSztJQURUO1dBRUE7QUFIRzs7QUFLUCxTQUFBLEdBQVksU0FBQyxHQUFELEVBQU0sT0FBTjtBQUVSLFFBQUE7O1FBRmMsVUFBUTs7SUFFdEIsR0FBQSxHQUFNLFNBQUMsQ0FBRCxFQUFHLENBQUg7QUFDRixZQUFBO1FBQUEsQ0FBQSxHQUFJO0FBQ0osYUFBQSxNQUFBOztZQUNJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTztBQURYO0FBRUEsYUFBQSxNQUFBOztZQUNJLElBQWdCLFlBQWhCO2dCQUFBLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxFQUFQOztBQURKO2VBRUE7SUFORTtJQVFOLEdBQUEsR0FBTSxHQUFBLENBQUksT0FBSixFQUFhLFFBQWI7SUFRTixJQUFHLEdBQUcsQ0FBQyxHQUFKLEtBQVcsT0FBZDtRQUNJLEVBQUEsR0FBSyxJ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QUEsS0FBSyxFQUFMLElBQVksSUFBWixJQUFxQixHQUFyQixJQUE0QjtvQkFDaEMsSUFBYSxDQUFDLENBQUMsTUFBRixJQUFhLEdBQUEsS0FBSyxFQUEvQjt3QkFBQSxDQUFBLElBQUssS0FBTDs7b0JBQ0EsQ0FBQSxJQUFLOztBQUFDOzZCQUFBLG1DQUFBOzt5Q0FBQSxHQUFBLEdBQUksS0FBQSxDQUFNLENBQU4sRUFBUSxHQUFBLEdBQUksTUFBWixFQUFtQixJQUFuQixFQUF3QixPQUF4QjtBQUFKOzt3QkFBRCxDQUFpRCxDQUFDLElBQWxELENBQXVELElBQXZELEVBSFQ7aUJBQUEsTUFJSywwQ0FBZ0IsQ0FBRSxjQUFmLEtBQXVCLFFBQTFCO0FBQ0QsMkJBQU8sQ0FBQyxDQUFDLE9BRFI7aUJBQUEsTUFBQTtvQkFHRCxDQUFBLEdBQUksQ0FBQyxJQUFBLElBQVMsS0FBVixDQUFBLElBQW9CLENBQUMsQ0FBQyxHQUFBLEtBQU8sRUFBUixDQUFBLElBQWdCLElBQWhCLElBQXdCLEVBQXpCO29CQUN4QixDQUFBLElBQUssTUFBQSxDQUFPLENBQVAsRUFBVSxHQUFWLEVBQWUsT0FBZixFQUpKOztBQUtMLHVCQUFPO0FBcEJmO0FBc0JRLHVCQUFPLE1BQUEsQ0FBTyxDQUFQO0FBdEJmO0FBdUJBLGVBQU87SUFoQ0g7SUFrQ1IsQ0FBQSxHQUFJLEtBQUEsQ0FBTSxHQUFOO0lBQ0osSUFBRyxHQUFHLENBQUMsTUFBUDtRQUNJLENBQUEsR0FBSSxPQUFBLENBQVEsTUFBUixDQUFlLENBQUMsTUFBaEIsQ0FBdUI7WUFBQSxJQUFBLEVBQUssQ0FBTDtZQUFRLEdBQUEsRUFBSSxNQUFaO1NBQXZCLEVBRFI7O1dBRUE7QUFsSlE7O0FBb0paLE1BQU0sQ0FBQyxPQUFQLEdBQWlCIiwic291cmNlc0NvbnRlbnQiOlsiIyMjXG4gMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMFxuMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwIDAwMCBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAgICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICAwMDAwMDAgICAgICAwMDAwMCAgXG4gICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbiMjI1xuXG5kZWZhdWx0cyA9XG4gICAgZXh0OiAgICAgICcubm9vbicgIyBvdXRwdXQgZm9ybWF0XG4gICAgaW5kZW50OiAgIDQgICAgICAgIyBudW1iZXIgb2Ygc3BhY2VzIHBlciBpbmRlbnQgbGV2ZWxcbiAgICBhbGlnbjogICAgdHJ1ZSAgICAjIHZlcnRpY2FsbHkgYWxpZ24gb2JqZWN0IHZhbHVlc1xuICAgIG1heGFsaWduOiAzMiAgICAgICMgbWF4aW1hbCBudW1iZXIgb2Ygc3BhY2VzIHdoZW4gYWxpZ25pbmdcbiAgICBzb3J0OiAgICAgZmFsc2UgICAjIHNvcnQgb2JqZWN0IGtleXMgYWxwaGFiZXRpY2FsbHlcbiAgICBjaXJjdWxhcjogZmFsc2UgICAjIGNoZWNrIGZvciBjaXJjdWxhciByZWZlcmVuY2VzIChleHBlbnNpdmUhKVxuICAgIG51bGw6ICAgICBmYWxzZSAgICMgb3V0cHV0IG51bGwgZGljdGlvbmFyeSB2YWx1ZXNcbiAgICBjb2xvcnM6ICAgZmFsc2UgICAjIGNvbG9yaXplIG91dHB1dCB3aXRoIGFuc2kgY29sb3JzXG4gICAgICAgICAgICAgICAgICAgICAgIyB0cnVlIGZvciBkZWZhdWx0IGNvbG9ycyBvciBjdXN0b20gZGljdGlvbmFyeVxuICAgIFxucmVncyA9IFxuICAgIHVybDogICAgbmV3IFJlZ0V4cCAnXihodHRwcz98Z2l0fGZpbGUpKDovLykoXFxcXFMrKSQnXG4gICAgcGF0aDogICBuZXcgUmVnRXhwICdeKFtcXFxcLlxcXFwvXFxcXFNdKykoXFxcXC9cXFxcUyspJCdcbiAgICBzZW12ZXI6IG5ldyBSZWdFeHAgJ1xcXFxkK1xcXFwuXFxcXGQrXFxcXC5cXFxcZCsnXG5cbnJwYWQgPSAocywgbCkgLT4gXG4gICAgd2hpbGUgcy5sZW5ndGggPCBsXG4gICAgICAgIHMgKz0gJyAnXG4gICAgc1xuICAgIFxuc3RyaW5naWZ5ID0gKG9iaiwgb3B0aW9ucz17fSkgLT5cblxuICAgIGRlZiA9IChvLGQpIC0+XG4gICAgICAgIHIgPSB7fVxuICAgICAgICBmb3Igayx2IG9mIG9cbiAgICAgICAgICAgIHJba10gPSB2XG4gICAgICAgIGZvciBrLHYgb2YgZFxuICAgICAgICAgICAgcltrXSA9IHYgaWYgbm90IHJba10/XG4gICAgICAgIHJcblxuICAgIG9wdCA9IGRlZiBvcHRpb25zLCBkZWZhdWx0c1xuICAgIFxuICAgICMgICAgICAgMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAwMDBcbiAgICAjICAgICAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwMCAgMDAwXG4gICAgIyAgICAgICAwMDAgIDAwMDAwMDAgICAwMDAgICAwMDAgIDAwMCAwIDAwMFxuICAgICMgMDAwICAgMDAwICAgICAgIDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMDBcbiAgICAjICAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgMDAwICAgMDAwXG4gICAgICAgIFxuICAgIGlmIG9wdC5leHQgPT0gJy5qc29uJ1xuICAgICAgICBjcyA9IEpTT04uc3RyaW5naWZ5IG9iaiwgbnVsbCwgb3B0LmluZGVudFxuICAgICAgICBpZiBvcHQuY29sb3JzXG4gICAgICAgICAgICByZXR1cm4gcmVxdWlyZSgna2xvcicpLnN5bnRheCB0ZXh0OmNzLCBleHQ6b3B0LmV4dFxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gY3NcbiAgICBcbiAgICBpZiB0eXBlb2Ygb3B0LmluZGVudCA9PSAnc3RyaW5nJyBcbiAgICAgICAgb3B0LmluZGVudCA9IG9wdC5pbmRlbnQubGVuZ3RoXG4gICAgICAgIFxuICAgIGluZHN0ciA9IHJwYWQgJycsIG9wdC5pbmRlbnRcbiAgICAgICAgICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwXG4gICAgIyAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgICAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAwMDAwIFxuICAgICMgMDAwICAgICAgICAgICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgXG4gICAgIyAwMDAwMDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwMDAwMDBcblxuICAgIGVzY2FwZSA9IChrLCBhcnJ5KSAtPlxuICAgICAgICBpZiAwIDw9IGsuaW5kZXhPZiAnXFxuJ1xuICAgICAgICAgICAgc3AgPSBrLnNwbGl0ICdcXG4nXG4gICAgICAgICAgICBlcyA9IHNwLm1hcCAocykgLT4gZXNjYXBlKHMsIGFycnkpXG4gICAgICAgICAgICBlcy51bnNoaWZ0ICcuLi4nXG4gICAgICAgICAgICBlcy5wdXNoICcuLi4nXG4gICAgICAgICAgICByZXR1cm4gZXMuam9pbiAnXFxuJ1xuICAgICAgICBpZiBrID09ICcnIG9yIGsgPT0gJy4uLicgb3Iga1swXSBpbiBbJyAnLCAnIycsICd8J10gb3Iga1trLmxlbmd0aC0xXSBpbiBbJyAnLCAnIycsICd8J10gXG4gICAgICAgICAgICBrID0gJ3wnICsgayArICd8J1xuICAgICAgICBlbHNlIGlmIGFycnkgYW5kIC9cXCBcXCAvLnRlc3Qga1xuICAgICAgICAgICAgayA9ICd8JyArIGsgKyAnfCdcbiAgICAgICAga1xuICAgIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwICAgMDAwXG4gICAgIyAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAgMDAwIDAwMCBcbiAgICAjIDAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAgICAgMDAwICAgICAgICAwMDAgICAgICAgMDAwMDAgIFxuICAgICMgMDAwICAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgICAgIDAwMCAgICAgICAgMDAwICAgXG4gICAgIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAgIDAwMCAgICAgICAgMDAwICAgICAgICAwMDAgICBcbiAgICBcbiAgICBwcmV0dHkgPSAobywgaW5kLCB2aXNpdGVkKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgb3B0LmFsaWduICAgICAgICBcbiAgICAgICAgICAgIG1heEtleSA9IG9wdC5pbmRlbnRcbiAgICAgICAgICAgIGlmIE9iamVjdC5rZXlzKG8pLmxlbmd0aCA+IDFcbiAgICAgICAgICAgICAgICBmb3Igb3duIGssdiBvZiBvXG4gICAgICAgICAgICAgICAgICAgIGtsID0gcGFyc2VJbnQoTWF0aC5jZWlsKChrLmxlbmd0aCsyKS9vcHQuaW5kZW50KSpvcHQuaW5kZW50KVxuICAgICAgICAgICAgICAgICAgICBtYXhLZXkgPSBNYXRoLm1heCBtYXhLZXksIGtsXG4gICAgICAgICAgICAgICAgICAgIGlmIG9wdC5tYXhhbGlnbiBhbmQgKG1heEtleSA+IG9wdC5tYXhhbGlnbilcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heEtleSA9IG9wdC5tYXhhbGlnblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgbCA9IFtdXG4gICAgICAgIFxuICAgICAgICBrZXlWYWx1ZSA9IChrLHYpIC0+XG4gICAgICAgICAgICBzID0gaW5kXG4gICAgICAgICAgICBrID0gZXNjYXBlIGssIHRydWVcbiAgICAgICAgICAgIGlmIGsuaW5kZXhPZignICAnKSA+IDAgYW5kIGtbMF0gIT0gJ3wnXG4gICAgICAgICAgICAgICAgayA9IFwifCN7a318XCJcbiAgICAgICAgICAgIGVsc2UgaWYga1swXSAhPSAnfCcgYW5kIGtbay5sZW5ndGgtMV0gPT0gJ3wnXG4gICAgICAgICAgICAgICAgayA9ICd8JyArIGtcbiAgICAgICAgICAgIGVsc2UgaWYga1swXSA9PSAnfCcgYW5kIGtbay5sZW5ndGgtMV0gIT0gJ3wnXG4gICAgICAgICAgICAgICAgayArPSAnfCdcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgb3B0LmFsaWduXG4gICAgICAgICAgICAgICAga3MgPSBycGFkIGssIE1hdGgubWF4IG1heEtleSwgay5sZW5ndGgrMlxuICAgICAgICAgICAgICAgIGkgID0gcnBhZCBpbmQraW5kc3RyLCBtYXhLZXlcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBrcyA9IHJwYWQgaywgay5sZW5ndGgrMlxuICAgICAgICAgICAgICAgIGkgID0gaW5kK2luZHN0clxuICAgICAgICAgICAgcyArPSBrc1xuICAgICAgICAgICAgdnMgPSB0b1N0ciB2LCBpLCBmYWxzZSwgdmlzaXRlZFxuICAgICAgICAgICAgaWYgdnNbMF0gPT0gJ1xcbidcbiAgICAgICAgICAgICAgICB3aGlsZSBzW3MubGVuZ3RoLTFdID09ICcgJ1xuICAgICAgICAgICAgICAgICAgICBzID0gcy5zdWJzdHIgMCwgcy5sZW5ndGgtMSAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHMgKz0gdnNcbiAgICAgICAgICAgIHdoaWxlIHNbcy5sZW5ndGgtMV0gPT0gJyAnXG4gICAgICAgICAgICAgICAgcyA9IHMuc3Vic3RyIDAsIHMubGVuZ3RoLTFcbiAgICAgICAgICAgIHNcblxuICAgICAgICBpZiBvcHQuc29ydFxuICAgICAgICAgICAgZm9yIGsgaW4gT2JqZWN0LmtleXMobykuc29ydCgpXG4gICAgICAgICAgICAgICAgbC5wdXNoIGtleVZhbHVlIGssIG9ba11cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZm9yIG93biBrLHYgb2Ygb1xuICAgICAgICAgICAgICAgIGwucHVzaCBrZXlWYWx1ZSBrLCB2XG4gICAgICAgICAgICBcbiAgICAgICAgbC5qb2luICdcXG4nXG5cbiAgICAjIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwICBcbiAgICAjICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAjICAgIDAwMCAgICAgIDAwMDAwMDAgICAwMDAwMDAwICAgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICBcbiAgICB0b1N0ciA9IChvLCBpbmQ9JycsIGFycnk9ZmFsc2UsIHZpc2l0ZWQ9W10pIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBub3Qgbz8gXG4gICAgICAgICAgICBpZiBvID09IG51bGxcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0Lm51bGwgb3IgYXJyeSBhbmQgXCJudWxsXCIgb3IgJydcbiAgICAgICAgICAgIGlmIG8gPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCJcbiAgICAgICAgICAgIHJldHVybiAnPD8+J1xuICAgICAgICAgICAgXG4gICAgICAgIHN3aXRjaCB0ID0gdHlwZW9mIG9cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgd2hlbiAnc3RyaW5nJyBcbiAgICAgICAgICAgICAgICByZXR1cm4gZXNjYXBlIG8sIGFycnlcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHdoZW4gJ29iamVjdCdcbiAgICAgICAgICAgICAgICBpZiBvcHQuY2lyY3VsYXJcbiAgICAgICAgICAgICAgICAgICAgaWYgbyBpbiB2aXNpdGVkXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzx2PidcbiAgICAgICAgICAgICAgICAgICAgdmlzaXRlZC5wdXNoIG9cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgby5jb25zdHJ1Y3Rvcj8ubmFtZSA9PSAnQXJyYXknXG4gICAgICAgICAgICAgICAgICAgIHMgPSBpbmQhPScnIGFuZCBhcnJ5IGFuZCAnLicgb3IgJydcbiAgICAgICAgICAgICAgICAgICAgcyArPSAnXFxuJyBpZiBvLmxlbmd0aCBhbmQgaW5kIT0nJ1xuICAgICAgICAgICAgICAgICAgICBzICs9IChpbmQrdG9TdHIodixpbmQraW5kc3RyLHRydWUsdmlzaXRlZCkgZm9yIHYgaW4gbykuam9pbiAnXFxuJ1xuICAgICAgICAgICAgICAgIGVsc2UgaWYgby5jb25zdHJ1Y3Rvcj8ubmFtZSA9PSAnUmVnRXhwJ1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gby5zb3VyY2VcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHMgPSAoYXJyeSBhbmQgJy5cXG4nKSBvciAoKGluZCAhPSAnJykgYW5kICdcXG4nIG9yICcnKVxuICAgICAgICAgICAgICAgICAgICBzICs9IHByZXR0eSBvLCBpbmQsIHZpc2l0ZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gc1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcgb1xuICAgICAgICByZXR1cm4gJzw/Pz8+J1xuXG4gICAgcyA9IHRvU3RyIG9ialxuICAgIGlmIG9wdC5jb2xvcnNcbiAgICAgICAgcyA9IHJlcXVpcmUoJ2tsb3InKS5zeW50YXggdGV4dDpzLCBleHQ6J25vb24nXG4gICAgc1xuXG5tb2R1bGUuZXhwb3J0cyA9IHN0cmluZ2lmeVxuIl19
//# sourceURL=../coffee/stringify.coffee