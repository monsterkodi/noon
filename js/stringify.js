// koffee 0.56.0

/*
 0000000  000000000  00000000   000  000   000   0000000   000  00000000  000   000
000          000     000   000  000  0000  000  000        000  000        000 000 
0000000      000     0000000    000  000 0 000  000  0000  000  000000      00000  
     000     000     000   000  000  000  0000  000   000  000  000          000   
0000000      000     000   000  000  000   000   0000000   000  000          000
 */
var defaults, regs, rpad, stringify,
    hasProp = {}.hasOwnProperty,
    indexOf = [].indexOf;

defaults = {
    ext: '.noon',
    indent: 4,
    align: true,
    maxalign: 32,
    sort: false,
    circular: false,
    "null": false,
    colors: false
};

regs = {
    url: new RegExp('^(https?|git|file)(://)(\\S+)$'),
    path: new RegExp('^([\\.\\/\\S]+)(\\/\\S+)$'),
    semver: new RegExp('\\d+\\.\\d+\\.\\d+')
};

rpad = function(s, l) {
    while (s.length < l) {
        s += ' ';
    }
    return s;
};

stringify = function(obj, options) {
    var beautify, colors, def, defaultColors, escape, indstr, noop, opt, pretty, s, toStr;
    if (options == null) {
        options = {};
    }
    def = function(o, d) {
        var k, r, v;
        r = {};
        for (k in o) {
            v = o[k];
            r[k] = v;
        }
        for (k in d) {
            v = d[k];
            if (r[k] == null) {
                r[k] = v;
            }
        }
        return r;
    };
    opt = def(options, defaults);
    switch (opt.ext) {
        case '.json':
            return JSON.stringify(obj, null, opt.indent);
        case '.yml':
        case '.yaml':
            return require('js-yaml').dump(obj);
    }
    if (typeof opt.indent === 'string') {
        opt.indent = opt.indent.length;
    }
    indstr = rpad('', opt.indent);

    /*
     0000000   0000000   000       0000000   00000000    0000000
    000       000   000  000      000   000  000   000  000     
    000       000   000  000      000   000  0000000    0000000 
    000       000   000  000      000   000  000   000       000
     0000000   0000000   0000000   0000000   000   000  0000000
     */
    if (opt.colors === false || opt.colors === 0) {
        noop = function(s) {
            return s;
        };
        colors = {
            url: noop,
            key: noop,
            "null": noop,
            "true": noop,
            "false": noop,
            path: noop,
            value: noop,
            string: noop,
            semver: noop,
            number: noop,
            visited: noop,
            special: noop
        };
    } else {
        require('klor').kolor.globalize();
        defaultColors = {
            url: yellow,
            key: gray,
            "null": blue,
            "true": function(s) {
                return blue(bold(s));
            },
            "false": function(s) {
                return gray(dim(s));
            },
            path: green,
            value: white,
            string: function(s) {
                return white(bold(s));
            },
            semver: red,
            number: magenta,
            visited: red,
            dim: '^>=.:/-'
        };
        if (opt.colors === true) {
            colors = defaultColors;
        } else {
            colors = def(opt.colors, defaultColors);
        }
    }

    /*
    00000000   0000000   0000000   0000000   00000000   00000000
    000       000       000       000   000  000   000  000     
    0000000   0000000   000       000000000  00000000   0000000 
    000            000  000       000   000  000        000     
    00000000  0000000    0000000  000   000  000        00000000
     */
    escape = function(k, arry) {
        var es, ref, ref1, sp;
        if (0 <= k.indexOf('\n')) {
            sp = k.split('\n');
            es = sp.map(function(s) {
                return escape(s, arry);
            });
            es.unshift('...');
            es.push('...');
            return es.join('\n');
        }
        if (k === '' || k === '...' || ((ref = k[0]) === ' ' || ref === '#' || ref === '|') || ((ref1 = k[k.length - 1]) === ' ' || ref1 === '#' || ref1 === '|')) {
            k = '|' + k + '|';
        } else if (arry && /\ \ /.test(k)) {
            k = '|' + k + '|';
        }
        return k;
    };

    /*
    0000000    00000000   0000000   000   000  000000000  000  00000000  000   000
    000   000  000       000   000  000   000     000     000  000        000 000 
    0000000    0000000   000000000  000   000     000     000  000000      00000  
    000   000  000       000   000  000   000     000     000  000          000   
    0000000    00000000  000   000   0000000      000     000  000          000
     */
    beautify = function(s) {
        var c, j, len, ref;
        if (colors.dim != null) {
            ref = colors.dim;
            for (j = 0, len = ref.length; j < len; j++) {
                c = ref[j];
                s = s.replace(new RegExp("\\" + c, 'g'), dim(c));
            }
        }
        return s;
    };

    /*
    00000000   00000000   00000000  000000000  000000000  000   000
    000   000  000   000  000          000        000      000 000 
    00000000   0000000    0000000      000        000       00000  
    000        000   000  000          000        000        000   
    000        000   000  00000000     000        000        000
     */
    pretty = function(o, ind, visited) {
        var j, k, keyValue, kl, l, len, maxKey, ref, v;
        if (opt.align) {
            maxKey = opt.indent;
            if (Object.keys(o).length > 1) {
                for (k in o) {
                    if (!hasProp.call(o, k)) continue;
                    v = o[k];
                    kl = parseInt(Math.ceil((k.length + 2) / opt.indent) * opt.indent);
                    maxKey = Math.max(maxKey, kl);
                    if (opt.maxalign && (maxKey > opt.maxalign)) {
                        maxKey = opt.maxalign;
                        break;
                    }
                }
            }
        }
        l = [];
        keyValue = function(k, v) {
            var i, ks, s, vs;
            s = ind;
            k = escape(k, true);
            if (k.indexOf('  ') > 0 && k[0] !== '|') {
                k = "|" + k + "|";
            } else if (k[0] !== '|' && k[k.length - 1] === '|') {
                k = '|' + k;
            } else if (k[0] === '|' && k[k.length - 1] !== '|') {
                k += '|';
            }
            if (opt.align) {
                ks = rpad(k, Math.max(maxKey, k.length + 2));
                i = rpad(ind + indstr, maxKey);
            } else {
                ks = rpad(k, k.length + 2);
                i = ind + indstr;
            }
            s += colors.key(opt.colors !== false && s.length === 0 && bold(ks) || ks);
            vs = toStr(v, i, false, visited);
            if (vs[0] === '\n') {
                while (s[s.length - 1] === ' ') {
                    s = s.substr(0, s.length - 1);
                }
            }
            s += vs;
            while (s[s.length - 1] === ' ') {
                s = s.substr(0, s.length - 1);
            }
            return s;
        };
        if (opt.sort) {
            ref = Object.keys(o).sort();
            for (j = 0, len = ref.length; j < len; j++) {
                k = ref[j];
                l.push(keyValue(k, o[k]));
            }
        } else {
            for (k in o) {
                if (!hasProp.call(o, k)) continue;
                v = o[k];
                l.push(keyValue(k, v));
            }
        }
        return l.join('\n');
    };

    /*
    000000000   0000000    0000000  000000000  00000000 
       000     000   000  000          000     000   000
       000     000   000  0000000      000     0000000  
       000     000   000       000     000     000   000
       000      0000000   0000000      000     000   000
     */
    toStr = function(o, ind, arry, visited) {
        var j, len, rc, ref, ref1, ref2, s, t, v;
        if (ind == null) {
            ind = '';
        }
        if (arry == null) {
            arry = false;
        }
        if (visited == null) {
            visited = [];
        }
        if (o == null) {
            if (o === null) {
                return opt["null"] || arry && colors["null"]("null") || '';
            }
            if (o === void 0) {
                return colors["null"]("undefined");
            }
            return colors["null"]('<?>');
        }
        t = typeof o;
        if (t === 'string') {
            if (opt.colors !== false) {
                ref = Object.keys(regs);
                for (j = 0, len = ref.length; j < len; j++) {
                    rc = ref[j];
                    if ((colors[rc] != null) && regs[rc].test(o)) {
                        return colors[rc](beautify(escape(o, arry)));
                    }
                }
            }
            return colors.string(escape(o, arry));
        } else if (t === 'object') {
            if (opt.circular) {
                if (indexOf.call(visited, o) >= 0) {
                    return colors.visited('<v>');
                }
                visited.push(o);
            }
            if (((ref1 = o.constructor) != null ? ref1.name : void 0) === 'Array') {
                s = ind !== '' && arry && '.' || '';
                if (o.length && ind !== '') {
                    s += '\n';
                }
                s += ((function() {
                    var len1, m, results;
                    results = [];
                    for (m = 0, len1 = o.length; m < len1; m++) {
                        v = o[m];
                        results.push(ind + toStr(v, ind + indstr, true, visited));
                    }
                    return results;
                })()).join('\n');
            } else if (((ref2 = o.constructor) != null ? ref2.name : void 0) === 'RegExp') {
                return colors.semver(o.source);
            } else {
                s = (arry && '.\n') || ((ind !== '') && '\n' || '');
                s += pretty(o, ind, visited);
            }
            return s;
        } else if (t === 'number') {
            return colors.number(String(o));
        } else if (t === 'boolean') {
            return (o && colors["true"] || colors["false"])(String(o));
        } else {
            return colors.value(String(o));
        }
        return colors["null"]('<???>');
    };
    s = toStr(obj);
    return s;
};

module.exports = stringify;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyaW5naWZ5LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSwrQkFBQTtJQUFBOzs7QUFRQSxRQUFBLEdBQ0k7SUFBQSxHQUFBLEVBQVUsT0FBVjtJQUNBLE1BQUEsRUFBVSxDQURWO0lBRUEsS0FBQSxFQUFVLElBRlY7SUFHQSxRQUFBLEVBQVUsRUFIVjtJQUlBLElBQUEsRUFBVSxLQUpWO0lBS0EsUUFBQSxFQUFVLEtBTFY7SUFNQSxDQUFBLElBQUEsQ0FBQSxFQUFVLEtBTlY7SUFPQSxNQUFBLEVBQVUsS0FQVjs7O0FBVUosSUFBQSxHQUNJO0lBQUEsR0FBQSxFQUFRLElBQUksTUFBSixDQUFXLGdDQUFYLENBQVI7SUFDQSxJQUFBLEVBQVEsSUFBSSxNQUFKLENBQVcsMkJBQVgsQ0FEUjtJQUVBLE1BQUEsRUFBUSxJQUFJLE1BQUosQ0FBVyxvQkFBWCxDQUZSOzs7QUFJSixJQUFBLEdBQU8sU0FBQyxDQUFELEVBQUksQ0FBSjtBQUNILFdBQU0sQ0FBQyxDQUFDLE1BQUYsR0FBVyxDQUFqQjtRQUNJLENBQUEsSUFBSztJQURUO1dBRUE7QUFIRzs7QUFLUCxTQUFBLEdBQVksU0FBQyxHQUFELEVBQU0sT0FBTjtBQUVSLFFBQUE7O1FBRmMsVUFBUTs7SUFFdEIsR0FBQSxHQUFNLFNBQUMsQ0FBRCxFQUFHLENBQUg7QUFDRixZQUFBO1FBQUEsQ0FBQSxHQUFJO0FBQ0osYUFBQSxNQUFBOztZQUNJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTztBQURYO0FBRUEsYUFBQSxNQUFBOztZQUNJLElBQWdCLFlBQWhCO2dCQUFBLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxFQUFQOztBQURKO2VBRUE7SUFORTtJQVFOLEdBQUEsR0FBTSxHQUFBLENBQUksT0FBSixFQUFhLFFBQWI7QUFFTixZQUFPLEdBQUcsQ0FBQyxHQUFYO0FBQUEsYUFDUyxPQURUO0FBQzhCLG1CQUFP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MCAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMCAgMDAwICAgMDAwICAgMDAwMDAwMCAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMFxuMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwICAgICAgICAwMDAgIDAwMCAgICAgICAgMDAwIDAwMCBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAgICAgMDAwICAwMDAgMCAwMDAgIDAwMCAgMDAwMCAgMDAwICAwMDAwMDAgICAgICAwMDAwMCAgXG4gICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgMDAwICAwMDAwICAwMDAgICAwMDAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbiMjI1xuXG5kZWZhdWx0cyA9XG4gICAgZXh0OiAgICAgICcubm9vbicgIyBvdXRwdXQgZm9ybWF0XG4gICAgaW5kZW50OiAgIDQgICAgICAgIyBudW1iZXIgb2Ygc3BhY2VzIHBlciBpbmRlbnQgbGV2ZWxcbiAgICBhbGlnbjogICAgdHJ1ZSAgICAjIHZlcnRpY2FsbHkgYWxpZ24gb2JqZWN0IHZhbHVlc1xuICAgIG1heGFsaWduOiAzMiAgICAgICMgbWF4aW1hbCBudW1iZXIgb2Ygc3BhY2VzIHdoZW4gYWxpZ25pbmdcbiAgICBzb3J0OiAgICAgZmFsc2UgICAjIHNvcnQgb2JqZWN0IGtleXMgYWxwaGFiZXRpY2FsbHlcbiAgICBjaXJjdWxhcjogZmFsc2UgICAjIGNoZWNrIGZvciBjaXJjdWxhciByZWZlcmVuY2VzIChleHBlbnNpdmUhKVxuICAgIG51bGw6ICAgICBmYWxzZSAgICMgb3V0cHV0IG51bGwgZGljdGlvbmFyeSB2YWx1ZXNcbiAgICBjb2xvcnM6ICAgZmFsc2UgICAjIGNvbG9yaXplIG91dHB1dCB3aXRoIGFuc2kgY29sb3JzXG4gICAgICAgICAgICAgICAgICAgICAgIyB0cnVlIGZvciBkZWZhdWx0IGNvbG9ycyBvciBjdXN0b20gZGljdGlvbmFyeVxuICAgIFxucmVncyA9IFxuICAgIHVybDogICAgbmV3IFJlZ0V4cCAnXihodHRwcz98Z2l0fGZpbGUpKDovLykoXFxcXFMrKSQnXG4gICAgcGF0aDogICBuZXcgUmVnRXhwICdeKFtcXFxcLlxcXFwvXFxcXFNdKykoXFxcXC9cXFxcUyspJCdcbiAgICBzZW12ZXI6IG5ldyBSZWdFeHAgJ1xcXFxkK1xcXFwuXFxcXGQrXFxcXC5cXFxcZCsnXG5cbnJwYWQgPSAocywgbCkgLT4gXG4gICAgd2hpbGUgcy5sZW5ndGggPCBsXG4gICAgICAgIHMgKz0gJyAnXG4gICAgc1xuICAgIFxuc3RyaW5naWZ5ID0gKG9iaiwgb3B0aW9ucz17fSkgLT5cblxuICAgIGRlZiA9IChvLGQpIC0+XG4gICAgICAgIHIgPSB7fVxuICAgICAgICBmb3Igayx2IG9mIG9cbiAgICAgICAgICAgIHJba10gPSB2XG4gICAgICAgIGZvciBrLHYgb2YgZFxuICAgICAgICAgICAgcltrXSA9IHYgaWYgbm90IHJba10/XG4gICAgICAgIHJcblxuICAgIG9wdCA9IGRlZiBvcHRpb25zLCBkZWZhdWx0c1xuICAgIFxuICAgIHN3aXRjaCBvcHQuZXh0XG4gICAgICAgIHdoZW4gJy5qc29uJyAgICAgICAgIHRoZW4gcmV0dXJuIEpTT04uc3RyaW5naWZ5IG9iaiwgbnVsbCwgb3B0LmluZGVudFxuICAgICAgICB3aGVuICcueW1sJywgJy55YW1sJyB0aGVuIHJldHVybiByZXF1aXJlKCdqcy15YW1sJykuZHVtcCBvYmpcbiAgICBcbiAgICBpZiB0eXBlb2Ygb3B0LmluZGVudCA9PSAnc3RyaW5nJyBcbiAgICAgICAgb3B0LmluZGVudCA9IG9wdC5pbmRlbnQubGVuZ3RoXG4gICAgaW5kc3RyID0gcnBhZCAnJywgb3B0LmluZGVudFxuICAgIFxuICAgICMjI1xuICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMCAgICAgICAwMDAwMDAwICAgMDAwMDAwMDAgICAgMDAwMDAwMFxuICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIFxuICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMCAgICAwMDAwMDAwIFxuICAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAgIDAwMFxuICAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwIFxuICAgICMjI1xuICAgIFxuICAgIGlmIG9wdC5jb2xvcnMgPT0gZmFsc2Ugb3Igb3B0LmNvbG9ycyA9PSAwXG4gICAgICAgIG5vb3AgPSAocykgLT4gc1xuICAgICAgICBjb2xvcnMgPSBcbiAgICAgICAgICAgIHVybDogICAgIG5vb3BcbiAgICAgICAgICAgIGtleTogICAgIG5vb3BcbiAgICAgICAgICAgIG51bGw6ICAgIG5vb3BcbiAgICAgICAgICAgIHRydWU6ICAgIG5vb3BcbiAgICAgICAgICAgIGZhbHNlOiAgIG5vb3BcbiAgICAgICAgICAgIHBhdGg6ICAgIG5vb3BcbiAgICAgICAgICAgIHZhbHVlOiAgIG5vb3BcbiAgICAgICAgICAgIHN0cmluZzogIG5vb3BcbiAgICAgICAgICAgIHNlbXZlcjogIG5vb3BcbiAgICAgICAgICAgIG51bWJlcjogIG5vb3BcbiAgICAgICAgICAgIHZpc2l0ZWQ6IG5vb3BcbiAgICAgICAgICAgIHNwZWNpYWw6IG5vb3BcbiAgICBlbHNlXG4gICAgICAgIHJlcXVpcmUoJ2tsb3InKS5rb2xvci5nbG9iYWxpemUoKVxuICAgICAgICBkZWZhdWx0Q29sb3JzID1cbiAgICAgICAgICAgIHVybDogICAgIHllbGxvd1xuICAgICAgICAgICAga2V5OiAgICAgZ3JheVxuICAgICAgICAgICAgbnVsbDogICAgYmx1ZVxuICAgICAgICAgICAgdHJ1ZTogICAgKHMpIC0+IGJsdWUgYm9sZCBzXG4gICAgICAgICAgICBmYWxzZTogICAocykgLT4gZ3JheSBkaW0gc1xuICAgICAgICAgICAgcGF0aDogICAgZ3JlZW5cbiAgICAgICAgICAgIHZhbHVlOiAgIHdoaXRlXG4gICAgICAgICAgICBzdHJpbmc6ICAocykgLT4gd2hpdGUgYm9sZCBzXG4gICAgICAgICAgICBzZW12ZXI6ICByZWRcbiAgICAgICAgICAgIG51bWJlcjogIG1hZ2VudGFcbiAgICAgICAgICAgIHZpc2l0ZWQ6IHJlZFxuICAgICAgICAgICAgZGltOiAgICAgJ14+PS46Ly0nXG4gICAgICAgIGlmIG9wdC5jb2xvcnMgPT0gdHJ1ZVxuICAgICAgICAgICAgY29sb3JzID0gZGVmYXVsdENvbG9yc1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBjb2xvcnMgPSBkZWYgb3B0LmNvbG9ycywgZGVmYXVsdENvbG9yc1xuXG4gICAgIyMjXG4gICAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwMCAgIDAwMDAwMDAwXG4gICAgMDAwICAgICAgIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAwMDAgIDAwMCAgICAgXG4gICAgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgMDAwICAgICAgICAgICAgMDAwICAwMDAgICAgICAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMCAgICAgXG4gICAgMDAwMDAwMDAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgIDAwMDAwMDAwXG4gICAgIyMjXG5cbiAgICBlc2NhcGUgPSAoaywgYXJyeSkgLT5cbiAgICAgICAgaWYgMCA8PSBrLmluZGV4T2YgJ1xcbidcbiAgICAgICAgICAgIHNwID0gay5zcGxpdCAnXFxuJ1xuICAgICAgICAgICAgZXMgPSBzcC5tYXAgKHMpIC0+IGVzY2FwZShzLCBhcnJ5KVxuICAgICAgICAgICAgZXMudW5zaGlmdCAnLi4uJ1xuICAgICAgICAgICAgZXMucHVzaCAnLi4uJ1xuICAgICAgICAgICAgcmV0dXJuIGVzLmpvaW4gJ1xcbidcbiAgICAgICAgaWYgayA9PSAnJyBvciBrID09ICcuLi4nIG9yIGtbMF0gaW4gWycgJywgJyMnLCAnfCddIG9yIGtbay5sZW5ndGgtMV0gaW4gWycgJywgJyMnLCAnfCddIFxuICAgICAgICAgICAgayA9ICd8JyArIGsgKyAnfCdcbiAgICAgICAgZWxzZSBpZiBhcnJ5IGFuZCAvXFwgXFwgLy50ZXN0IGtcbiAgICAgICAgICAgIGsgPSAnfCcgKyBrICsgJ3wnXG4gICAgICAgIGtcblxuICAgICMjI1xuICAgIDAwMDAwMDAgICAgMDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAwMDAwMDAgIDAwMCAgMDAwMDAwMDAgIDAwMCAgIDAwMFxuICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwICAgICAgICAwMDAgMDAwIFxuICAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMDAwMDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwMDAwICAgICAgMDAwMDAgIFxuICAgIDAwMCAgIDAwMCAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAgICAwMDAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuICAgIDAwMDAwMDAgICAgMDAwMDAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgIFxuICAgICMjI1xuICAgIFxuICAgIGJlYXV0aWZ5ID0gKHMpIC0+IFxuICAgICAgICBpZiBjb2xvcnMuZGltP1xuICAgICAgICAgICAgZm9yIGMgaW4gY29sb3JzLmRpbVxuICAgICAgICAgICAgICAgIHMgPSBzLnJlcGxhY2UgbmV3IFJlZ0V4cChcIlxcXFwje2N9XCIsICdnJyksIGRpbSBjXG4gICAgICAgIHNcbiAgICBcbiAgICAjIyNcbiAgICAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDBcbiAgICAwMDAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAgMDAwIDAwMCBcbiAgICAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgICAgIDAwMCAgICAgICAgMDAwICAgICAgIDAwMDAwICBcbiAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAgICAwMDAgICBcbiAgICAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwMDAwMDAgICAgIDAwMCAgICAgICAgMDAwICAgICAgICAwMDAgICBcbiAgICAjIyNcbiAgICBcbiAgICBwcmV0dHkgPSAobywgaW5kLCB2aXNpdGVkKSAtPlxuICAgICAgICBcbiAgICAgICAgaWYgb3B0LmFsaWduICAgICAgICBcbiAgICAgICAgICAgIG1heEtleSA9IG9wdC5pbmRlbnRcbiAgICAgICAgICAgIGlmIE9iamVjdC5rZXlzKG8pLmxlbmd0aCA+IDFcbiAgICAgICAgICAgICAgICBmb3Igb3duIGssdiBvZiBvXG4gICAgICAgICAgICAgICAgICAgIGtsID0gcGFyc2VJbnQoTWF0aC5jZWlsKChrLmxlbmd0aCsyKS9vcHQuaW5kZW50KSpvcHQuaW5kZW50KVxuICAgICAgICAgICAgICAgICAgICBtYXhLZXkgPSBNYXRoLm1heCBtYXhLZXksIGtsXG4gICAgICAgICAgICAgICAgICAgIGlmIG9wdC5tYXhhbGlnbiBhbmQgKG1heEtleSA+IG9wdC5tYXhhbGlnbilcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heEtleSA9IG9wdC5tYXhhbGlnblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgbCA9IFtdXG4gICAgICAgIFxuICAgICAgICBrZXlWYWx1ZSA9IChrLHYpIC0+XG4gICAgICAgICAgICBzID0gaW5kXG4gICAgICAgICAgICBrID0gZXNjYXBlIGssIHRydWVcbiAgICAgICAgICAgIGlmIGsuaW5kZXhPZignICAnKSA+IDAgYW5kIGtbMF0gIT0gJ3wnXG4gICAgICAgICAgICAgICAgayA9IFwifCN7a318XCJcbiAgICAgICAgICAgIGVsc2UgaWYga1swXSAhPSAnfCcgYW5kIGtbay5sZW5ndGgtMV0gPT0gJ3wnXG4gICAgICAgICAgICAgICAgayA9ICd8JyArIGtcbiAgICAgICAgICAgIGVsc2UgaWYga1swXSA9PSAnfCcgYW5kIGtbay5sZW5ndGgtMV0gIT0gJ3wnXG4gICAgICAgICAgICAgICAgayArPSAnfCdcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgb3B0LmFsaWduXG4gICAgICAgICAgICAgICAga3MgPSBycGFkIGssIE1hdGgubWF4IG1heEtleSwgay5sZW5ndGgrMlxuICAgICAgICAgICAgICAgIGkgID0gcnBhZCBpbmQraW5kc3RyLCBtYXhLZXlcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBrcyA9IHJwYWQgaywgay5sZW5ndGgrMlxuICAgICAgICAgICAgICAgIGkgID0gaW5kK2luZHN0clxuICAgICAgICAgICAgcyArPSBjb2xvcnMua2V5IG9wdC5jb2xvcnMgIT0gZmFsc2UgYW5kIHMubGVuZ3RoID09IDAgYW5kIGJvbGQoa3MpIG9yIGtzXG4gICAgICAgICAgICB2cyA9IHRvU3RyIHYsIGksIGZhbHNlLCB2aXNpdGVkXG4gICAgICAgICAgICBpZiB2c1swXSA9PSAnXFxuJ1xuICAgICAgICAgICAgICAgIHdoaWxlIHNbcy5sZW5ndGgtMV0gPT0gJyAnXG4gICAgICAgICAgICAgICAgICAgIHMgPSBzLnN1YnN0ciAwLCBzLmxlbmd0aC0xICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgcyArPSB2c1xuICAgICAgICAgICAgd2hpbGUgc1tzLmxlbmd0aC0xXSA9PSAnICdcbiAgICAgICAgICAgICAgICBzID0gcy5zdWJzdHIgMCwgcy5sZW5ndGgtMVxuICAgICAgICAgICAgc1xuXG4gICAgICAgIGlmIG9wdC5zb3J0XG4gICAgICAgICAgICBmb3IgayBpbiBPYmplY3Qua2V5cyhvKS5zb3J0KClcbiAgICAgICAgICAgICAgICBsLnB1c2gga2V5VmFsdWUgaywgb1trXVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBmb3Igb3duIGssdiBvZiBvXG4gICAgICAgICAgICAgICAgbC5wdXNoIGtleVZhbHVlIGssIHZcbiAgICAgICAgICAgIFxuICAgICAgICBsLmpvaW4gJ1xcbidcblxuICAgICMjI1xuICAgIDAwMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAwMDAwMCBcbiAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgMDAwICAgMDAwXG4gICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAgIFxuICAgICAgIDAwMCAgICAgMDAwICAgMDAwICAgICAgIDAwMCAgICAgMDAwICAgICAwMDAgICAwMDBcbiAgICAgICAwMDAgICAgICAwMDAwMDAwICAgMDAwMDAwMCAgICAgIDAwMCAgICAgMDAwICAgMDAwXG4gICAgIyMjXG4gICAgXG4gICAgdG9TdHIgPSAobywgaW5kPScnLCBhcnJ5PWZhbHNlLCB2aXNpdGVkPVtdKSAtPlxuICAgICAgICBpZiBub3Qgbz8gXG4gICAgICAgICAgICBpZiBvID09IG51bGxcbiAgICAgICAgICAgICAgICByZXR1cm4gb3B0Lm51bGwgb3IgYXJyeSBhbmQgY29sb3JzLm51bGwoXCJudWxsXCIpIG9yICcnXG4gICAgICAgICAgICBpZiBvID09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIHJldHVybiBjb2xvcnMubnVsbCBcInVuZGVmaW5lZFwiXG4gICAgICAgICAgICByZXR1cm4gY29sb3JzLm51bGwgJzw/PidcbiAgICAgICAgdCA9IHR5cGVvZiBvXG4gICAgICAgIGlmIHQgPT0gJ3N0cmluZycgXG4gICAgICAgICAgICBpZiBvcHQuY29sb3JzICE9IGZhbHNlXG4gICAgICAgICAgICAgICAgZm9yIHJjIGluIE9iamVjdC5rZXlzIHJlZ3NcbiAgICAgICAgICAgICAgICAgICAgaWYgY29sb3JzW3JjXT8gYW5kIHJlZ3NbcmNdLnRlc3Qgb1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICBjb2xvcnNbcmNdIGJlYXV0aWZ5IGVzY2FwZSBvLCBhcnJ5XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gY29sb3JzLnN0cmluZyBlc2NhcGUgbywgYXJyeVxuICAgICAgICBlbHNlIGlmIHQgPT0gJ29iamVjdCdcbiAgICAgICAgICAgIGlmIG9wdC5jaXJjdWxhclxuICAgICAgICAgICAgICAgIGlmIG8gaW4gdmlzaXRlZFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29sb3JzLnZpc2l0ZWQgJzx2PidcbiAgICAgICAgICAgICAgICB2aXNpdGVkLnB1c2ggb1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgby5jb25zdHJ1Y3Rvcj8ubmFtZSA9PSAnQXJyYXknXG4gICAgICAgICAgICAgICAgcyA9IGluZCE9JycgYW5kIGFycnkgYW5kICcuJyBvciAnJ1xuICAgICAgICAgICAgICAgIHMgKz0gJ1xcbicgaWYgby5sZW5ndGggYW5kIGluZCE9JydcbiAgICAgICAgICAgICAgICBzICs9IChpbmQrdG9TdHIodixpbmQraW5kc3RyLHRydWUsdmlzaXRlZCkgZm9yIHYgaW4gbykuam9pbiAnXFxuJ1xuICAgICAgICAgICAgZWxzZSBpZiBvLmNvbnN0cnVjdG9yPy5uYW1lID09ICdSZWdFeHAnXG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbG9ycy5zZW12ZXIgby5zb3VyY2VcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBzID0gKGFycnkgYW5kICcuXFxuJykgb3IgKChpbmQgIT0gJycpIGFuZCAnXFxuJyBvciAnJylcbiAgICAgICAgICAgICAgICBzICs9IHByZXR0eSBvLCBpbmQsIHZpc2l0ZWRcbiAgICAgICAgICAgIHJldHVybiBzXG4gICAgICAgIGVsc2UgaWYgdCA9PSAnbnVtYmVyJ1xuICAgICAgICAgICAgcmV0dXJuIGNvbG9ycy5udW1iZXIgU3RyaW5nIG9cbiAgICAgICAgZWxzZSBpZiB0ID09ICdib29sZWFuJ1xuICAgICAgICAgICAgcmV0dXJuIChvIGFuZCBjb2xvcnMudHJ1ZSBvciBjb2xvcnMuZmFsc2UpIFN0cmluZyBvXG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBjb2xvcnMudmFsdWUgU3RyaW5nIG8gIyBwbGFpbiB2YWx1ZXNcbiAgICAgICAgcmV0dXJuIGNvbG9ycy5udWxsICc8Pz8/PidcblxuICAgIHMgPSB0b1N0ciBvYmpcbiAgICBzXG5cbm1vZHVsZS5leHBvcnRzID0gc3RyaW5naWZ5XG4iXX0=
//# sourceURL=../coffee/stringify.coffee