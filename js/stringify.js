// koffee 1.3.0

/*
 0000000  000000000  00000000   000  000   000   0000000   000  00000000  000   000
000          000     000   000  000  0000  000  000        000  000        000 000 
0000000      000     0000000    000  000 0 000  000  0000  000  000000      00000  
     000     000     000   000  000  000  0000  000   000  000  000          000   
0000000      000     000   000  000  000   000   0000000   000  000          000
 */
var defaults, regs, rpad, stringify,
    hasProp = {}.hasOwnProperty,
    indexOf = [].indexOf;

defaults = {
    ext: '.noon',
    indent: 4,
    align: true,
    maxalign: 32,
    sort: false,
    circular: false,
    "null": false,
    colors: false
};

regs = {
    url: new RegExp('^(https?|git|file)(://)(\\S+)$'),
    path: new RegExp('^([\\.\\/\\S]+)(\\/\\S+)$'),
    semver: new RegExp('\\d+\\.\\d+\\.\\d+')
};

rpad = function(s, l) {
    while (s.length < l) {
        s += ' ';
    }
    return s;
};

stringify = function(obj, options) {
    var cs, def, escape, indstr, opt, pretty, s, toStr;
    if (options == null) {
        options = {};
    }
    def = function(o, d) {
        var k, r, v;
        r = {};
        for (k in o) {
            v = o[k];
            r[k] = v;
        }
        for (k in d) {
            v = d[k];
            if (r[k] == null) {
                r[k] = v;
            }
        }
        return r;
    };
    opt = def(options, defaults);
    switch (opt.ext) {
        case '.json':
            cs = JSON.stringify(obj, null, opt.indent);
            break;
        case '.yml':
        case '.yaml':
            cs = require('js-yaml').dump(obj);
    }
    if (cs) {
        if (opt.colors) {
            return require('klor').syntax({
                text: cs,
                ext: opt.ext
            });
        } else {
            return cs;
        }
    }
    if (typeof opt.indent === 'string') {
        opt.indent = opt.indent.length;
    }
    indstr = rpad('', opt.indent);
    escape = function(k, arry) {
        var es, ref, ref1, sp;
        if (0 <= k.indexOf('\n')) {
            sp = k.split('\n');
            es = sp.map(function(s) {
                return escape(s, arry);
            });
            es.unshift('...');
            es.push('...');
            return es.join('\n');
        }
        if (k === '' || k === '...' || ((ref = k[0]) === ' ' || ref === '#' || ref === '|') || ((ref1 = k[k.length - 1]) === ' ' || ref1 === '#' || ref1 === '|')) {
            k = '|' + k + '|';
        } else if (arry && /\ \ /.test(k)) {
            k = '|' + k + '|';
        }
        return k;
    };
    pretty = function(o, ind, visited) {
        var j, k, keyValue, kl, l, len, maxKey, ref, v;
        if (opt.align) {
            maxKey = opt.indent;
            if (Object.keys(o).length > 1) {
                for (k in o) {
                    if (!hasProp.call(o, k)) continue;
                    v = o[k];
                    kl = parseInt(Math.ceil((k.length + 2) / opt.indent) * opt.indent);
                    maxKey = Math.max(maxKey, kl);
                    if (opt.maxalign && (maxKey > opt.maxalign)) {
                        maxKey = opt.maxalign;
                        break;
                    }
                }
            }
        }
        l = [];
        keyValue = function(k, v) {
            var i, ks, s, vs;
            s = ind;
            k = escape(k, true);
            if (k.indexOf('  ') > 0 && k[0] !== '|') {
                k = "|" + k + "|";
            } else if (k[0] !== '|' && k[k.length - 1] === '|') {
                k = '|' + k;
            } else if (k[0] === '|' && k[k.length - 1] !== '|') {
                k += '|';
            }
            if (opt.align) {
                ks = rpad(k, Math.max(maxKey, k.length + 2));
                i = rpad(ind + indstr, maxKey);
            } else {
                ks = rpad(k, k.length + 2);
                i = ind + indstr;
            }
            s += ks;
            vs = toStr(v, i, false, visited);
            if (vs[0] === '\n') {
                while (s[s.length - 1] === ' ') {
                    s = s.substr(0, s.length - 1);
                }
            }
            s += vs;
            while (s[s.length - 1] === ' ') {
                s = s.substr(0, s.length - 1);
            }
            return s;
        };
        if (opt.sort) {
            ref = Object.keys(o).sort();
            for (j = 0, len = ref.length; j < len; j++) {
                k = ref[j];
                l.push(keyValue(k, o[k]));
            }
        } else {
            for (k in o) {
                if (!hasProp.call(o, k)) continue;
                v = o[k];
                l.push(keyValue(k, v));
            }
        }
        return l.join('\n');
    };
    toStr = function(o, ind, arry, visited) {
        var ref, ref1, s, t, v;
        if (ind == null) {
            ind = '';
        }
        if (arry == null) {
            arry = false;
        }
        if (visited == null) {
            visited = [];
        }
        if (o == null) {
            if (o === null) {
                return opt["null"] || arry && "null" || '';
            }
            if (o === void 0) {
                return "undefined";
            }
            return '<?>';
        }
        switch (t = typeof o) {
            case 'string':
                return escape(o, arry);
            case 'object':
                if (opt.circular) {
                    if (indexOf.call(visited, o) >= 0) {
                        return '<v>';
                    }
                    visited.push(o);
                }
                if (((ref = o.constructor) != null ? ref.name : void 0) === 'Array') {
                    s = ind !== '' && arry && '.' || '';
                    if (o.length && ind !== '') {
                        s += '\n';
                    }
                    s += ((function() {
                        var j, len, results;
                        results = [];
                        for (j = 0, len = o.length; j < len; j++) {
                            v = o[j];
                            results.push(ind + toStr(v, ind + indstr, true, visited));
                        }
                        return results;
                    })()).join('\n');
                } else if (((ref1 = o.constructor) != null ? ref1.name : void 0) === 'RegExp') {
                    return o.source;
                } else {
                    s = (arry && '.\n') || ((ind !== '') && '\n' || '');
                    s += pretty(o, ind, visited);
                }
                return s;
            default:
                return String(o);
        }
        return '<???>';
    };
    s = toStr(obj);
    if (opt.colors) {
        s = require('klor').syntax({
            text: s,
            ext: 'noon'
        });
    }
    return s;
};

module.exports = stringify;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RyaW5naWZ5LmpzIiwic291cmNlUm9vdCI6Ii4iLCJzb3VyY2VzIjpbIiJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7O0FBQUEsSUFBQSwrQkFBQTtJQUFBOzs7QUFRQSxRQUFBLEdBQ0k7SUFBQSxHQUFBLEVBQVUsT0FBVjtJQUNBLE1BQUEsRUFBVSxDQURWO0lBRUEsS0FBQSxFQUFVLElBRlY7SUFHQSxRQUFBLEVBQVUsRUFIVjtJQUlBLElBQUEsRUFBVSxLQUpWO0lBS0EsUUFBQSxFQUFVLEtBTFY7SUFNQSxDQUFBLElBQUEsQ0FBQSxFQUFVLEtBTlY7SUFPQSxNQUFBLEVBQVUsS0FQVjs7O0FBVUosSUFBQSxHQUNJO0lBQUEsR0FBQSxFQUFRLElBQUksTUFBSixDQUFXLGdDQUFYLENBQVI7SUFDQSxJQUFBLEVBQVEsSUFBSSxNQUFKLENBQVcsMkJBQVgsQ0FEUjtJQUVBLE1BQUEsRUFBUSxJQUFJLE1BQUosQ0FBVyxvQkFBWCxDQUZSOzs7QUFJSixJQUFBLEdBQU8sU0FBQyxDQUFELEVBQUksQ0FBSjtBQUNILFdBQU0sQ0FBQyxDQUFDLE1BQUYsR0FBVyxDQUFqQjtRQUNJLENBQUEsSUFBSztJQURUO1dBRUE7QUFIRzs7QUFLUCxTQUFBLEdBQVksU0FBQyxHQUFELEVBQU0sT0FBTjtBQUVSLFFBQUE7O1FBRmMsVUFBUTs7SUFFdEIsR0FBQSxHQUFNLFNBQUMsQ0FBRCxFQUFHLENBQUg7QUFDRixZQUFBO1FBQUEsQ0FBQSxHQUFJO0FBQ0osYUFBQSxNQUFBOztZQUNJLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTztBQURYO0FBRUEsYUFBQSxNQUFBOztZQUNJLElBQWdCLFlBQWhCO2dCQUFBLENBQUUsQ0FBQSxDQUFBLENBQUYsR0FBTyxFQUFQOztBQURKO2VBRUE7SUFORTtJQVFOLEdBQUEsR0FBTSxHQUFBLENBQUksT0FBSixFQUFhLFFBQWI7QUFRTixZQUFPLEdBQUcsQ0FBQyxHQUFYO0FBQUEsYUFDUyxPQURUO1lBRVEsRUFBQSxH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b250ZW50IjpbIiMjI1xuIDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAgICAwMDAgIDAwMCAgIDAwMCAgIDAwMDAwMDAgICAwMDAgIDAwMDAwMDAwICAwMDAgICAwMDBcbjAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAwMDAgIDAwMCAgICAgICAgMDAwICAwMDAgICAgICAgIDAwMCAwMDAgXG4wMDAwMDAwICAgICAgMDAwICAgICAwMDAwMDAwICAgIDAwMCAgMDAwIDAgMDAwICAwMDAgIDAwMDAgIDAwMCAgMDAwMDAwICAgICAgMDAwMDAgIFxuICAgICAwMDAgICAgIDAwMCAgICAgMDAwICAgMDAwICAwMDAgIDAwMCAgMDAwMCAgMDAwICAgMDAwICAwMDAgIDAwMCAgICAgICAgICAwMDAgICBcbjAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMCAgMDAwICAwMDAgICAwMDAgICAwMDAwMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgXG4jIyNcblxuZGVmYXVsdHMgPVxuICAgIGV4dDogICAgICAnLm5vb24nICMgb3V0cHV0IGZvcm1hdFxuICAgIGluZGVudDogICA0ICAgICAgICMgbnVtYmVyIG9mIHNwYWNlcyBwZXIgaW5kZW50IGxldmVsXG4gICAgYWxpZ246ICAgIHRydWUgICAgIyB2ZXJ0aWNhbGx5IGFsaWduIG9iamVjdCB2YWx1ZXNcbiAgICBtYXhhbGlnbjogMzIgICAgICAjIG1heGltYWwgbnVtYmVyIG9mIHNwYWNlcyB3aGVuIGFsaWduaW5nXG4gICAgc29ydDogICAgIGZhbHNlICAgIyBzb3J0IG9iamVjdCBrZXlzIGFscGhhYmV0aWNhbGx5XG4gICAgY2lyY3VsYXI6IGZhbHNlICAgIyBjaGVjayBmb3IgY2lyY3VsYXIgcmVmZXJlbmNlcyAoZXhwZW5zaXZlISlcbiAgICBudWxsOiAgICAgZmFsc2UgICAjIG91dHB1dCBudWxsIGRpY3Rpb25hcnkgdmFsdWVzXG4gICAgY29sb3JzOiAgIGZhbHNlICAgIyBjb2xvcml6ZSBvdXRwdXQgd2l0aCBhbnNpIGNvbG9yc1xuICAgICAgICAgICAgICAgICAgICAgICMgdHJ1ZSBmb3IgZGVmYXVsdCBjb2xvcnMgb3IgY3VzdG9tIGRpY3Rpb25hcnlcbiAgICBcbnJlZ3MgPSBcbiAgICB1cmw6ICAgIG5ldyBSZWdFeHAgJ14oaHR0cHM/fGdpdHxmaWxlKSg6Ly8pKFxcXFxTKykkJ1xuICAgIHBhdGg6ICAgbmV3IFJlZ0V4cCAnXihbXFxcXC5cXFxcL1xcXFxTXSspKFxcXFwvXFxcXFMrKSQnXG4gICAgc2VtdmVyOiBuZXcgUmVnRXhwICdcXFxcZCtcXFxcLlxcXFxkK1xcXFwuXFxcXGQrJ1xuXG5ycGFkID0gKHMsIGwpIC0+IFxuICAgIHdoaWxlIHMubGVuZ3RoIDwgbFxuICAgICAgICBzICs9ICcgJ1xuICAgIHNcbiAgICBcbnN0cmluZ2lmeSA9IChvYmosIG9wdGlvbnM9e30pIC0+XG5cbiAgICBkZWYgPSAobyxkKSAtPlxuICAgICAgICByID0ge31cbiAgICAgICAgZm9yIGssdiBvZiBvXG4gICAgICAgICAgICByW2tdID0gdlxuICAgICAgICBmb3Igayx2IG9mIGRcbiAgICAgICAgICAgIHJba10gPSB2IGlmIG5vdCByW2tdP1xuICAgICAgICByXG5cbiAgICBvcHQgPSBkZWYgb3B0aW9ucywgZGVmYXVsdHNcbiAgICBcbiAgICAjICAgICAgIDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwICAgMDAwICAgICAgICAwMDAgICAwMDAgIDAwICAgICAwMCAgMDAwICAgICAgXG4gICAgIyAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMDAgIDAwMCAgICAgICAgIDAwMCAwMDAgICAwMDAgICAwMDAgIDAwMCAgICAgIFxuICAgICMgICAgICAgMDAwICAwMDAwMDAwICAgMDAwICAgMDAwICAwMDAgMCAwMDAgICAgICAgICAgMDAwMDAgICAgMDAwMDAwMDAwICAwMDAgICAgICBcbiAgICAjIDAwMCAgIDAwMCAgICAgICAwMDAgIDAwMCAgIDAwMCAgMDAwICAwMDAwICAgICAgICAgICAwMDAgICAgIDAwMCAwIDAwMCAgMDAwICAgICAgXG4gICAgIyAgMDAwMDAwMCAgIDAwMDAwMDAgICAgMDAwMDAwMCAgIDAwMCAgIDAwMCAgICAgICAgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgIFxuICAgICAgICBcbiAgICBzd2l0Y2ggb3B0LmV4dFxuICAgICAgICB3aGVuICcuanNvbicgICBcbiAgICAgICAgICAgIGNzID0gSlNPTi5zdHJpbmdpZnkgb2JqLCBudWxsLCBvcHQuaW5kZW50XG4gICAgICAgIHdoZW4gJy55bWwnLCAnLnlhbWwnIFxuICAgICAgICAgICAgY3MgPSByZXF1aXJlKCdqcy15YW1sJykuZHVtcCBvYmpcbiAgICAgICAgICAgIFxuICAgIGlmIGNzXG4gICAgICAgIGlmIG9wdC5jb2xvcnNcbiAgICAgICAgICAgIHJldHVybiByZXF1aXJlKCdrbG9yJykuc3ludGF4IHRleHQ6Y3MsIGV4dDpvcHQuZXh0XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiBjc1xuICAgIFxuICAgIGlmIHR5cGVvZiBvcHQuaW5kZW50ID09ICdzdHJpbmcnIFxuICAgICAgICBvcHQuaW5kZW50ID0gb3B0LmluZGVudC5sZW5ndGhcbiAgICAgICAgXG4gICAgaW5kc3RyID0gcnBhZCAnJywgb3B0LmluZGVudFxuICAgICAgICAgICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAwMDAwICAgMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDBcbiAgICAjIDAwMCAgICAgICAwMDAgICAgICAgMDAwICAgICAgIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgIFxuICAgICMgMDAwMDAwMCAgIDAwMDAwMDAgICAwMDAgICAgICAgMDAwMDAwMDAwICAwMDAwMDAwMCAgIDAwMDAwMDAgXG4gICAgIyAwMDAgICAgICAgICAgICAwMDAgIDAwMCAgICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgMDAwICAgICBcbiAgICAjIDAwMDAwMDAwICAwMDAwMDAwICAgIDAwMDAwMDAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAwMDAwMDAwMFxuXG4gICAgZXNjYXBlID0gKGssIGFycnkpIC0+XG4gICAgICAgIGlmIDAgPD0gay5pbmRleE9mICdcXG4nXG4gICAgICAgICAgICBzcCA9IGsuc3BsaXQgJ1xcbidcbiAgICAgICAgICAgIGVzID0gc3AubWFwIChzKSAtPiBlc2NhcGUocywgYXJyeSlcbiAgICAgICAgICAgIGVzLnVuc2hpZnQgJy4uLidcbiAgICAgICAgICAgIGVzLnB1c2ggJy4uLidcbiAgICAgICAgICAgIHJldHVybiBlcy5qb2luICdcXG4nXG4gICAgICAgIGlmIGsgPT0gJycgb3IgayA9PSAnLi4uJyBvciBrWzBdIGluIFsnICcsICcjJywgJ3wnXSBvciBrW2subGVuZ3RoLTFdIGluIFsnICcsICcjJywgJ3wnXSBcbiAgICAgICAgICAgIGsgPSAnfCcgKyBrICsgJ3wnXG4gICAgICAgIGVsc2UgaWYgYXJyeSBhbmQgL1xcIFxcIC8udGVzdCBrXG4gICAgICAgICAgICBrID0gJ3wnICsgayArICd8J1xuICAgICAgICBrXG4gICAgXG4gICAgIyAwMDAwMDAwMCAgIDAwMDAwMDAwICAgMDAwMDAwMDAgIDAwMDAwMDAwMCAgMDAwMDAwMDAwICAwMDAgICAwMDBcbiAgICAjIDAwMCAgIDAwMCAgMDAwICAgMDAwICAwMDAgICAgICAgICAgMDAwICAgICAgICAwMDAgICAgICAwMDAgMDAwIFxuICAgICMgMDAwMDAwMDAgICAwMDAwMDAwICAgIDAwMDAwMDAgICAgICAwMDAgICAgICAgIDAwMCAgICAgICAwMDAwMCAgXG4gICAgIyAwMDAgICAgICAgIDAwMCAgIDAwMCAgMDAwICAgICAgICAgIDAwMCAgICAgICAgMDAwICAgICAgICAwMDAgICBcbiAgICAjIDAwMCAgICAgICAgMDAwICAgMDAwICAwMDAwMDAwMCAgICAgMDAwICAgICAgICAwMDAgICAgICAgIDAwMCAgIFxuICAgIFxuICAgIHByZXR0eSA9IChvLCBpbmQsIHZpc2l0ZWQpIC0+XG4gICAgICAgIFxuICAgICAgICBpZiBvcHQuYWxpZ24gICAgICAgIFxuICAgICAgICAgICAgbWF4S2V5ID0gb3B0LmluZGVudFxuICAgICAgICAgICAgaWYgT2JqZWN0LmtleXMobykubGVuZ3RoID4gMVxuICAgICAgICAgICAgICAgIGZvciBvd24gayx2IG9mIG9cbiAgICAgICAgICAgICAgICAgICAga2wgPSBwYXJzZUludChNYXRoLmNlaWwoKGsubGVuZ3RoKzIpL29wdC5pbmRlbnQpKm9wdC5pbmRlbnQpXG4gICAgICAgICAgICAgICAgICAgIG1heEtleSA9IE1hdGgubWF4IG1heEtleSwga2xcbiAgICAgICAgICAgICAgICAgICAgaWYgb3B0Lm1heGFsaWduIGFuZCAobWF4S2V5ID4gb3B0Lm1heGFsaWduKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4S2V5ID0gb3B0Lm1heGFsaWduXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVha1xuICAgICAgICBsID0gW11cbiAgICAgICAgXG4gICAgICAgIGtleVZhbHVlID0gKGssdikgLT5cbiAgICAgICAgICAgIHMgPSBpbmRcbiAgICAgICAgICAgIGsgPSBlc2NhcGUgaywgdHJ1ZVxuICAgICAgICAgICAgaWYgay5pbmRleE9mKCcgICcpID4gMCBhbmQga1swXSAhPSAnfCdcbiAgICAgICAgICAgICAgICBrID0gXCJ8I3trfXxcIlxuICAgICAgICAgICAgZWxzZSBpZiBrWzBdICE9ICd8JyBhbmQga1trLmxlbmd0aC0xXSA9PSAnfCdcbiAgICAgICAgICAgICAgICBrID0gJ3wnICsga1xuICAgICAgICAgICAgZWxzZSBpZiBrWzBdID09ICd8JyBhbmQga1trLmxlbmd0aC0xXSAhPSAnfCdcbiAgICAgICAgICAgICAgICBrICs9ICd8J1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiBvcHQuYWxpZ25cbiAgICAgICAgICAgICAgICBrcyA9IHJwYWQgaywgTWF0aC5tYXggbWF4S2V5LCBrLmxlbmd0aCsyXG4gICAgICAgICAgICAgICAgaSAgPSBycGFkIGluZCtpbmRzdHIsIG1heEtleVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGtzID0gcnBhZCBrLCBrLmxlbmd0aCsyXG4gICAgICAgICAgICAgICAgaSAgPSBpbmQraW5kc3RyXG4gICAgICAgICAgICBzICs9IGtzXG4gICAgICAgICAgICB2cyA9IHRvU3RyIHYsIGksIGZhbHNlLCB2aXNpdGVkXG4gICAgICAgICAgICBpZiB2c1swXSA9PSAnXFxuJ1xuICAgICAgICAgICAgICAgIHdoaWxlIHNbcy5sZW5ndGgtMV0gPT0gJyAnXG4gICAgICAgICAgICAgICAgICAgIHMgPSBzLnN1YnN0ciAwLCBzLmxlbmd0aC0xICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgcyArPSB2c1xuICAgICAgICAgICAgd2hpbGUgc1tzLmxlbmd0aC0xXSA9PSAnICdcbiAgICAgICAgICAgICAgICBzID0gcy5zdWJzdHIgMCwgcy5sZW5ndGgtMVxuICAgICAgICAgICAgc1xuXG4gICAgICAgIGlmIG9wdC5zb3J0XG4gICAgICAgICAgICBmb3IgayBpbiBPYmplY3Qua2V5cyhvKS5zb3J0KClcbiAgICAgICAgICAgICAgICBsLnB1c2gga2V5VmFsdWUgaywgb1trXVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICBmb3Igb3duIGssdiBvZiBvXG4gICAgICAgICAgICAgICAgbC5wdXNoIGtleVZhbHVlIGssIHZcbiAgICAgICAgICAgIFxuICAgICAgICBsLmpvaW4gJ1xcbidcblxuICAgICMgMDAwMDAwMDAwICAgMDAwMDAwMCAgICAwMDAwMDAwICAwMDAwMDAwMDAgIDAwMDAwMDAwIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMCAgICAgICAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMDAwMDAgIFxuICAgICMgICAgMDAwICAgICAwMDAgICAwMDAgICAgICAgMDAwICAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgICMgICAgMDAwICAgICAgMDAwMDAwMCAgIDAwMDAwMDAgICAgICAwMDAgICAgIDAwMCAgIDAwMFxuICAgIFxuICAgIHRvU3RyID0gKG8sIGluZD0nJywgYXJyeT1mYWxzZSwgdmlzaXRlZD1bXSkgLT5cbiAgICAgICAgXG4gICAgICAgIGlmIG5vdCBvPyBcbiAgICAgICAgICAgIGlmIG8gPT0gbnVsbFxuICAgICAgICAgICAgICAgIHJldHVybiBvcHQubnVsbCBvciBhcnJ5IGFuZCBcIm51bGxcIiBvciAnJ1xuICAgICAgICAgICAgaWYgbyA9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ1bmRlZmluZWRcIlxuICAgICAgICAgICAgcmV0dXJuICc8Pz4nXG4gICAgICAgICAgICBcbiAgICAgICAgc3dpdGNoIHQgPSB0eXBlb2Ygb1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB3aGVuICdzdHJpbmcnIFxuICAgICAgICAgICAgICAgIHJldHVybiBlc2NhcGUgbywgYXJyeVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgd2hlbiAnb2JqZWN0J1xuICAgICAgICAgICAgICAgIGlmIG9wdC5jaXJjdWxhclxuICAgICAgICAgICAgICAgICAgICBpZiBvIGluIHZpc2l0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPHY+J1xuICAgICAgICAgICAgICAgICAgICB2aXNpdGVkLnB1c2ggb1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiBvLmNvbnN0cnVjdG9yPy5uYW1lID09ICdBcnJheSdcbiAgICAgICAgICAgICAgICAgICAgcyA9IGluZCE9JycgYW5kIGFycnkgYW5kICcuJyBvciAnJ1xuICAgICAgICAgICAgICAgICAgICBzICs9ICdcXG4nIGlmIG8ubGVuZ3RoIGFuZCBpbmQhPScnXG4gICAgICAgICAgICAgICAgICAgIHMgKz0gKGluZCt0b1N0cih2LGluZCtpbmRzdHIsdHJ1ZSx2aXNpdGVkKSBmb3IgdiBpbiBvKS5qb2luICdcXG4nXG4gICAgICAgICAgICAgICAgZWxzZSBpZiBvLmNvbnN0cnVjdG9yPy5uYW1lID09ICdSZWdFeHAnXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvLnNvdXJjZVxuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcyA9IChhcnJ5IGFuZCAnLlxcbicpIG9yICgoaW5kICE9ICcnKSBhbmQgJ1xcbicgb3IgJycpXG4gICAgICAgICAgICAgICAgICAgIHMgKz0gcHJldHR5IG8sIGluZCwgdmlzaXRlZFxuICAgICAgICAgICAgICAgIHJldHVybiBzXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIFN0cmluZyBvXG4gICAgICAgIHJldHVybiAnPD8/Pz4nXG5cbiAgICBzID0gdG9TdHIgb2JqXG4gICAgaWYgb3B0LmNvbG9yc1xuICAgICAgICBzID0gcmVxdWlyZSgna2xvcicpLnN5bnRheCB0ZXh0OnMsIGV4dDonbm9vbidcbiAgICBzXG5cbm1vZHVsZS5leHBvcnRzID0gc3RyaW5naWZ5XG4iXX0=
//# sourceURL=../coffee/stringify.coffee